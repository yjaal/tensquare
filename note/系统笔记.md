# 系统笔记

# 一、安装docker

参考：`https://yq.aliyun.com/articles/625340`。

```shell
#安装curl
$ sudo apt-get update
$ sudo apt-get install curl

#安装软件包以允许apt通过HTTPS使用存储库
$ sudo apt-get install apt-transport-https ca-certificates curl software-properties-common

#添加Docker的官方GPG密钥
$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
#备注：可使用以下命令进行验证秘钥指纹 9DC8 5822 9FC7 DD38 854A E2D8 8D81 803C 0EBF CD88
$ sudo apt-key fingerprint 0EBFCD88

#可选设定稳定存储库，可不设置，则自动使用（deb [arch=amd64] https://download.docker.com/linux/ubuntu xenial stable）
$ sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu  xenial  stable"

#更新apt资源包，并进行安装docker ce
$ sudo apt-get update
$ sudo apt-get -y install docker-ce

#基础安装完成，可以先进行测试一下是否可用
$ sudo docker version

#如果执行时不想使用sudo命令，可以进行设置用户组，并将当前用户增加到该组中
$ sudo groupadd docker
$ sudo usermod -aG docker $USER

#注销一下，再执行以下命令
$ docker run hello-world

```



# 二、mysql镜像安装

这里使用官方镜像，相关安装内容参考：`https://hub.docker.com/_/mysql`。

```shell
$ docker pull mysql
```

![1](./assert/system/1.png)



```shell
docker run -di --name=tensquare_mysql -p 13306:3306 -e MYSQL_ROOT_PASSWORD=walp1314 mysql
```

![2](./assert/system/2.png)

然后使用工具连接上即可。然后将“建表语句”目录下的所有`sql`刷到数据库中。后面可以使用命令

```she
docker start tensquare_mysql
```

来启动已经存在的容器。



# 三、安装redis

参考：`https://hub.docker.com/_/redis`

```shell
docker run -di --name=tensquare_redis -p 16379:6379 redis:latest
```



# 四、安装mongoDB

参考：`https://hub.docker.com/_/mongo`

```shell
docker run -di --name=tensquare_mongo -p 27017:27017 mongo:latest
```

连接（当然需要有`mongo`的客户端）

```shell
mongo 10.10.10.254:27017
```



# 五、安装Elasticsearch

参考：`https://hub.docker.com/_/elasticsearch`

```shell
docker run -di --name=tensquare_es -e "discovery.type=single-node" -p 9300:9300 -p 9200:9200 elasticsearch:6.5.4
```

注意：`9300`端口是使用`tcp`客户端连接使用的端口。`9200`端口是通过`http`协议连接`es`使用的端口。我们在使用`java`访问的时候使用的是`9300`。同时`discovery.type=single-node`如果不加则启动容器后会自动退出且无法访问。

创建好容器之后使用命令

```shell
docker exec -it tensquare_es /bin/bash
```

进入到容器中的目录`config`中修改配置文件`elasticsearch.yml`

```yaml
cluster.name: "docker-cluster"
network.host: 0.0.0.0

# minimum_master_nodes need to be explicitly set when bound on a public IP
# set to 1 to allow single node clusters
# Details: https://github.com/elastic/elasticsearch/pull/17288
discovery.zen.minimum_master_nodes: 1

```

版本不同，会有差异，后面我们在`search`模块中配置的时候不仅要配置`ip`、端口，而且还要配置`cluster.name`。





















